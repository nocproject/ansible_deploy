---
- name: "Install PostgreSQL 1/2"
  pkgng:
    name: 'postgresql11-server'
    state: present
  tags:
    - requirements

- name: "Install PostgreSQL 2/2"
  pkgng:
    name: "{{ packages }}"
    state: present
  vars:
    packages:
      - 'py27-psycopg2'
      - 'postgresql11-contrib'
  tags:
    - requirements

- name: Enable postgres system service
  service:
    name: "{{ postgres_system_service }}"
    enabled: "True"

- name: PostgreSQL init db
  command: service postgresql initdb
  args:
    creates: "{{ postgresql_hba_path }}"

- name: Starting PostgreSQL service
  # This avoid this message:
  # pg_ctl: could not read file "/usr/local/pgsql/data/postmaster.opts"
  command: service postgresql start
  args:
    creates: /var/db/postgres/data11/postmaster.opts

---
- name: pre tasks
  hosts: all
  become: no
  any_errors_fatal: "{{tower_run_checks}}"
  gather_facts: True
  vars_files:
    - "vars/main.yml"
    - "vars/{{ ansible_distribution }}.yml"
  vars:
    ansible_tags: "{{ lookup('get_tags') }}"
  pre_tasks:
    - name: Run pre installation checks
      include_tasks: "{{item}}"
      with_myglob: ["./*_roles/*/tasks/checks.yml"]
      when: tower_run_checks
      tags:
        - checks

  roles:
    - role: pre
      tags:
        - pre

  post_tasks:
    - name: set pre complete
      set_fact:
        pre_complete: True

- name: set up dummy git user email
  git_config:
    name: user.email
    repo: "{{noc_root}}"
    scope: local
    value: 'noc_user@{{ ansible_fqdn }}'
  when: not git_user_email.stdout


- name: set up dummy git user name
  git_config:
    name: user.name
    repo: "{{noc_root}}"
    scope: local
    value: 'Noc User {{ansible_fqdn}}'
  when: not git_user_email.stdout

- name: Pull NOC
  git:
    repo: https://code.getnoc.com/noc/noc.git
    dest: "{{noc_root}}"
    version: microservices
    force: yes
    clone: yes
  environment:
    https_proxy: "{{http_proxy}}"
  tags:
    - mercurial

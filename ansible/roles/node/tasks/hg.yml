- name: Clean NOC directory
  hg:
    repo: "{{noc_repo}}"
    dest: "{{noc_root}}"
    revision: "{{noc_revision}}"
    force: yes
    purge: yes
  when: "'prod' in noc_env_type and noc_env_type is defined"
  environment:
    LC_ALL: C
  tags:
    - mercurial

- name: Pull NOC
  hg:
    repo: "{{noc_repo}}"
    dest: "{{noc_root}}"
    revision: "{{noc_revision}}"
    update: yes
  environment:
    LC_ALL: C
  tags:
    - mercurial

- name: Pull NOC Customizations
  hg:
    repo: "{{ noc_custom_repo }}"
    dest: "{{ noc_root }}/custom"
    revision: "{{ noc_custom_revision }}"
    update: yes
    force: yes
    purge: yes
  when: "noc_custom_enabled==True and noc_custom_repo is defined and noc_custom_revision is defined"
  environment:
    LC_ALL: C
  tags:
    - mercurial
    - custom
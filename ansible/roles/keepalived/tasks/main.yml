- name: "Include OS-specific tasks"
  include: "os/{{ ansible_distribution }}/main.yml"

- name: install keepalived.conf
  template:
    src: keepalived.conf.j2
    dest: "{{etc_prefix}}/keepalived/keepalived.conf"
  notify: reload keepalived
  tags:
    - keepalived
    - config

- name: install keepalived nginx.cnf
  template:
    src: nginx.cnf.j2
    dest: "{{etc_prefix}}/keepalived/nginx.cnf"
  notify: reload keepalived
  tags:
    - keepalived
    - config

- name: Start keepalived
  service:
    name: keepalived
    state: started
    enabled: yes
  tags:
    - keepalived
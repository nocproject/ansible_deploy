---
- name: Create postgres NOC user
  postgresql_user:
    name: "{{noc_pg_user}}"
    password: "{{noc_pg_password}}"
    login_user: "{{ postgres_user }}"
    db: postgres
    role_attr_flags: CREATEDB,NOSUPERUSER


- name: Create postgres Grafana user
  postgresql_user:
    name: "{{grafana_pg_user}}"
    password: '{{grafana_pg_password}}'
    login_user: "{{ postgres_user }}"
    db: postgres
    role_attr_flags: CREATEDB,NOSUPERUSER

- debug: var=postgres_superuser_password,postgres_replicator_password

- name: Create postgres useruser user
  postgresql_user:
    name: "superuser"
    password: '{{postgres_superuser_password}}'
    login_user: "{{ postgres_user }}"
    db: postgres
    role_attr_flags: SUPERUSER

- name: Create postgres replicator user
  postgresql_user:
    name: "replicator"
    password: '{{postgres_replicator_password}}'
    login_user: "{{ postgres_user }}"
    db: postgres
    role_attr_flags: REPLICATION

- name: Create postgres NOC database
  postgresql_db:
    name: "{{noc_pg_db}}"
    encoding: "UTF-8"
    owner: "{{noc_pg_user}}"
    login_user: "{{ postgres_user }}"
    state: "present"


- name: Create postgres Grafana database
  postgresql_db:
    name: "{{grafana_pg_db}}"
    encoding: "UTF-8"
    owner: "{{grafana_pg_user}}"
    login_user: "{{ postgres_user }}"
    state: "present"


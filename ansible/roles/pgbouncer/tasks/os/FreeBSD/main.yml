---
- name: Install pgbouncer
  pkgng: name="pgbouncer" state=present
  tags:
    - requirements

- name: Create pgbouncer directories
  file:
    path: "{{ item }}"
    owner: "pgbouncer"
    mode: 0700
    state: directory
  with_items:
    - /var/log/pgbouncer/
    - /var/run/pgbouncer/

- name: Install pgbouncer config
  template:
    src: "etc/pgbouncer/pgbouncer.ini.j2"
    dest: "{{etc_prefix}}/pgbouncer.ini"
  notify: reload pgbouncer
  tags:
    - config

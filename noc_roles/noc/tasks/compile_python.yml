---
- name: "Python{{ noc_py3_ver }} | Download precompiled archive"
  get_url:
    url: "https://cdn.getnoc.com/noc/repo/{{ ansible_os_family }}/python{{ py_version['py' ~ noc_py3_ver] }}.tar.gz"
    dest: "{{ tower_dist_dir }}/Python-{{ py_version['py' ~ noc_py3_ver] }}.tar.xz"
    #checksum: "md5:{{ py_hashes['py' ~ noc_py3_ver] }}"
  delegate_to: 127.0.0.1
  environment:
    https_proxy: "{{ http_proxy }}"
    http_proxy: "{{ http_proxy }}"

- name: "Python{{ noc_py3_ver }} | Create dir for extracting"
  file:
    path: "/opt/python{{ noc_py3_ver }}"
    state: directory

- name: "Python{{ noc_py3_ver }} | Uncompress"
  unarchive:
    src: "{{ tower_dist_dir }}/Python-{{ py_version['py' ~ noc_py3_ver] }}.tar.xz"
    dest: "/opt/python{{ noc_py3_ver }}/"
    creates: "/opt/python{{ noc_py3_ver }}/Python-{{ py_version['py' ~ noc_py3_ver] }}"

- name: Take path for new python3
  set_fact:
    noc_init_python_path: "/opt/python{{ noc_py3_ver }}/bin/python{{ noc_py3_ver }}"
